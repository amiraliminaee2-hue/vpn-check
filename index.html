<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>بررسی اتصال</title>
<style>
body {
    font-family: Tahoma, sans-serif;
    direction: rtl;
    text-align: center;
    background-color: #f5f5f5;
    margin-top: 80px;
}

.box {
    background: #fff;
    padding: 25px;
    max-width: 420px;
    margin: auto;
    border-radius: 8px;
    border: 1px solid #ddd;
}

button {
    margin-top: 15px;
    padding: 10px 20px;
    cursor: pointer;
}
</style>
</head>
<body>

<div id="content" class="box">
    در حال بررسی اتصال...
</div>

<script>
const MAIN_URL = "https://example.com";

// تابع کمکی برای چک VPN دقیق‌تر
async function checkVPN() {
    try {
        const res = await fetch("https://ipwho.is/");
        const data = await res.json();

        // بررسی دقیق‌تر: اگر proxy یا hosting یا نوع IP ناشناخته است
        const suspicious = 
            data.success === false ||
            data.proxy === true ||
            data.hosting === true ||
            !data.type || data.type === "hosting";

        if (suspicious) {
            document.getElementById("content").innerHTML = `
                ⚠️ <strong>احتمالاً فیلترشکن شما روشن است</strong>
                <br><br>
                لطفاً در صورت امکان فیلترشکن را خاموش کنید.
                <br><br>
                <button onclick="location.reload()">بررسی مجدد</button>
            `;
        } else {
            // اگر همه چیز درست است، وارد سایت شود
            window.location.href = MAIN_URL;
        }

    } catch (e) {
        // اگر API جواب نداد، ورود بده ولی می‌توان لاگ گرفت
        window.location.href = MAIN_URL;
    }
}

// جلوگیری از دور زدن با reload زیاد
if (!sessionStorage.getItem('vpnChecked')) {
    sessionStorage.setItem('vpnChecked', 'true');
    checkVPN();
} else {
    window.location.href = MAIN_URL;
}

</script>

</body>
</html>
